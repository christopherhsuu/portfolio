<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Pitch Sequences — Christopher Hsu</title>
    <link href="../styles.css" rel="stylesheet">
  </head>
  <body>
    <header class="site-header">
      <div class="container header-inner">
        <div class="brand">
          <a href="/" class="site-title">Christopher Hsu</a>
          <p class="tagline">Data Science &amp; Sabermetrics</p>
        </div>
        <nav aria-label="Main navigation">
          <ul class="nav-list">
            <li><a href="/">Home</a></li>
            <li><a href="/about.html">About</a></li>
          </ul>
        </nav>
      </div>
    </header>

    <main class="container section">
      <h1>Pitch Sequences</h1>
      <p class="muted">An interactive visualization of pitch sequences, pitch types, and swing outcomes. The app helps explore sequencing patterns and batter responses by zone and count.</p>

      <div style="margin-top:20px; display:flex; gap:12px; align-items:center;">
  <a class="launch-big" href="https://pitchsequence.streamlit.app/" target="_blank" rel="noopener noreferrer">Launch (Live)</a>
        <a class="btn ghost" href="https://github.com/christopherhsuu/pitchsequence/tree/main" target="_blank" rel="noopener noreferrer">Code</a>
      </div>

      <section style="margin-top:28px;">
        <h2>About PitchSequence</h2>
        <p class="muted">PitchSequence is a pitch-sequence recommender and run-value model that suggests next-pitch candidates in a given pitcher-vs-batter matchup and game state. It combines play-level Statcast data, derived batter archetypes, inferred pitcher arsenals, and a run-value prediction pipeline to rank pitches by expected run impact. The app is designed for practical use: a name-driven, stepwise UI lets users start an at-bat, pick a pitch, record the outcome, and immediately see updated recommendations.</p>

        <p class="muted">The data pipeline begins with raw Statcast play-by-play and name-mapping CSVs. A preprocessing step standardizes pitch types, normalizes names, and removes invalid rows; feature engineering extracts per-play features (plate_x/plate_z approximations, last-pitch deltas, zone buckets) and aggregates batter-vs-pitchtype statistics. Processed datasets are saved as Parquet for efficient training and app runtime. To ensure robust aggregates, the pipeline filters to players and pitch-types with sufficient exposure and applies sensible imputation and winsorization for outliers.</p>

        <p class="muted">The core model predicts run-value at the play level. Training loads the processed features and run-value labels, performs time-aware splits to avoid leakage, and builds a scikit-learn pipeline that handles encoding, imputation, scaling, and the estimator (e.g., GradientBoostingRegressor or RandomForestRegressor). Hyperparameters are tuned with grid/random search and cross-validation where appropriate, and the final pipeline is saved to `artifacts/runvalue_model.pkl` for production scoring. Inference combines model scores with batter-specific pitchtype aggregates; predicted run-values are converted into candidate probabilities by computing expected after-state run expectancy and applying a softmax over the negative expected runs to prioritize lower expected runs.</p>

        <p class="muted">The Streamlit UI implements a stepwise at-bat flow: select names for batter and pitcher, set count and base-state, and start the session. The app generates candidate pitches using the model when available, falls back to heuristics when necessary, and renders candidate rankings with percent probabilities and strike-zone visuals. Each chosen pitch can be recorded with its outcome, and the session updates counts and recomputes candidates — enabling interactive what-if experiments and strategy analysis.</p>

        <p class="muted">Key technical and product challenges included name normalization (ensuring the UI selects the correct player row), handling sparse batter-pitchtype exposures, and keeping the recommender robust when model predictions are noisy. The project addresses these by using name-mapping files, minimum-exposure thresholds, and blended model/heuristic scoring to maintain sensible outputs. Future improvements include richer batter-level features (Statcast swing/contact metrics), ensemble stacking for more accurate run-value estimates, and an analytics dashboard to evaluate how recommended sequences perform on holdout data.</p>

        <p class="muted">PitchSequence is practical for coaches, analysts, and researchers who want to explore sequencing decisions with both model-driven scores and transparent heuristics. The repo contains scripts to reproduce preprocessing, feature engineering, and training; deployment options include Streamlit Cloud for the interactive app and a serverless FastAPI endpoint for programmatic recommendations.</p>
      </section>

    </main>

    <footer class="site-footer">
      <div class="container">
        <p class="muted">© 2025 Christopher Hsu</p>
      </div>
    </footer>
  </body>
</html>