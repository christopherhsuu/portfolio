    <!-- Only keep the unified project container version below -->
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Batter Archetypes — Christopher Hsu</title>
    <link href="../styles.css" rel="stylesheet">
  </head>
  <body>
    <header class="site-header">
      <div class="container header-inner">
        <div class="brand">
          <a href="/" class="site-title">Christopher Hsu</a>
          <p class="tagline">Data Science &amp; Sabermetrics</p>
        </div>
        <nav aria-label="Main navigation">
          <ul class="nav-list">
            <li><a href="/">Home</a></li>
            <li><a href="/about.html">About</a></li>
          </ul>
        </nav>
      </div>
    </header>

    <main class="section page-inner" style="max-width:1400px; margin:32px auto 0 auto; background:#16161a; border-radius:18px; box-shadow:0 4px 32px 0 rgba(0,0,0,0.12);">
    <div class="project-container">
      <h1>Batter Archetypes</h1>
      <p class="muted">An exploratory clustering of hitters to identify archetypes (power/speed/contact/etc.) and visualize archetype profiles.</p>
      <section class="prose max-w-4xl text-gray-200 mt-8 space-y-6">
        <h2 class="font-bold text-2xl mt-8 mb-2">Methodology &amp; Execution</h2>
        <hr class="my-4 border-gray-700">

        <h3 class="font-bold text-xl mt-6 mb-2">Overview</h3>
        <p style="line-height:1.25em;">
          <strong>Hitter Archetypes</strong> is a sabermetric clustering pipeline and interactive <strong>Streamlit</strong> app designed to identify, classify, and visualize MLB hitter archetypes using aggregated Statcast and tracking data.
        </p>
        <p style="line-height:1.25em;">
          By combining swing mechanics, contact quality, and tracking-based features, the system groups hitters into data-driven archetypes (e.g., High-Launch Sluggers, Compact-Contact Hitters) using <strong>PCA</strong> for dimensionality reduction and <strong>KMeans</strong> for clustering. The final Streamlit interface enables interactive exploration of these groups—showing cluster centroids, representative players, and detailed diagnostics.
        </p>

        <h3 class="font-bold text-xl mt-6 mb-2">1. Data Preparation</h3>
        <ul class="list-disc ml-6 space-y-2">
          <li>All preprocessing occurs through the <code>scripts/</code> directory, supported by exploratory notebooks under <code>notebooks/</code>.</li>
        </ul>
        <h4 class="font-semibold text-lg mt-4 mb-2">Data sources</h4>
        <ul class="list-disc ml-6 space-y-1">
          <li>Raw Statcast, pitch-level, and swing-level CSVs stored in <code>data/raw/</code>.</li>
          <li>Name-mapping CSVs linking numeric player IDs to display names.</li>
        </ul>
        <h4 class="font-semibold text-lg mt-4 mb-2">Scripts used</h4>
        <ul class="list-disc ml-6 space-y-1">
          <li><code>scripts/cluster_archetypes.py</code> — main preprocessing and clustering script.</li>
          <li><code>scripts/add_player_names.py</code> — enriches player IDs with readable names.</li>
        </ul>
        <h4 class="font-semibold text-lg mt-4 mb-2">Workflow</h4>
        <ol class="list-decimal ml-6 space-y-1">
          <li><strong>Raw extraction:</strong> Pull data via Statcast queries or custom scripts (examples in <code>notebooks/get_savant_data.ipynb</code>).</li>
          <li><strong>Aggregation:</strong> Compute per-player feature aggregates such as:
            <ul class="list-disc ml-6 space-y-1">
              <li><code>launch_speed_mean</code>, <code>launch_angle_mean</code></li>
              <li><code>bat_speed_mean</code>, <code>pct_hard_hit</code></li>
              <li><code>swing_length_mean</code></li>
              <li><code>intercept_ball_minus_batter_pos_x_inches_mean</code></li>
              <li><code>n_swings</code></li>
            </ul>
            Aggregations include mean, standard deviation, median, and 95th-percentile metrics to capture consistency and upper-end performance.
          </li>
          <li><strong>Missing values and outliers:</strong>
            <ul class="list-disc ml-6 space-y-1">
              <li>Missing counts are replaced with 0 or ignored where complete data is required.</li>
              <li>Numeric features are winsorized at the 1st and 99th percentiles to mitigate the impact of extreme values before PCA.</li>
            </ul>
          </li>
          <li><strong>Circular features:</strong>
            <ul class="list-disc ml-6 space-y-1">
              <li>Angular stats like <code>attack_direction_mean</code> and <code>launch_angle_mean</code> are decomposed into sine and cosine components to avoid wrap-around discontinuities in distance computations.</li>
            </ul>
          </li>
          <li><strong>Name mapping:</strong> If available, <code>data/raw/unique_batters_with_names.csv</code> enriches numeric IDs into <code>name</code> or <code>name_display</code>. The app gracefully falls back to numeric IDs if mappings are absent.</li>
          <li><strong>Exports:</strong> Final aggregated data written to <code>data/player_archetypes.csv</code>, with per-cluster breakdowns exported later to <code>data/clusters/</code>.</li>
        </ol>
        <hr class="my-4 border-gray-700">

        <h3 class="font-bold text-xl mt-6 mb-2">2. Feature Engineering</h3>
        <table class="min-w-full text-sm border border-gray-700 mb-4">
          <thead>
            <tr class="bg-gray-800">
              <th class="px-4 py-2 text-left font-semibold">Category</th>
              <th class="px-4 py-2 text-left font-semibold">Example Features</th>
              <th class="px-4 py-2 text-left font-semibold">Purpose</th>
            </tr>
          </thead>
          <tbody>
            <tr class="bg-gray-900">
              <td class="px-4 py-2">Power &amp; Contact</td>
              <td class="px-4 py-2"><code>launch_speed_mean</code>, <code>pct_hard_hit</code></td>
              <td class="px-4 py-2">Quantify exit velocity and contact strength</td>
            </tr>
            <tr class="bg-gray-800">
              <td class="px-4 py-2">Swing Mechanics</td>
              <td class="px-4 py-2"><code>bat_speed_mean</code>, <code>swing_length_mean</code>, <code>swing_path_tilt_mean</code></td>
              <td class="px-4 py-2">Capture bat speed and swing geometry</td>
            </tr>
            <tr class="bg-gray-900">
              <td class="px-4 py-2">Timing &amp; Intercept</td>
              <td class="px-4 py-2"><code>intercept_ball_minus_batter_pos_x_inches_mean</code>, <code>intercept_ball_minus_batter_pos_y_inches_mean</code></td>
              <td class="px-4 py-2">Model timing offset and impact zone alignment</td>
            </tr>
            <tr class="bg-gray-800">
              <td class="px-4 py-2">Angles</td>
              <td class="px-4 py-2"><code>launch_angle_mean</code>, <code>attack_angle_mean</code>, <code>attack_direction_mean</code></td>
              <td class="px-4 py-2">Capture directional tendencies (converted to sin/cos)</td>
            </tr>
            <tr class="bg-gray-900">
              <td class="px-4 py-2">Sample Size</td>
              <td class="px-4 py-2"><code>n_swings</code></td>
              <td class="px-4 py-2">Used for filtering and log transforms</td>
            </tr>
          </tbody>
        </table>
        <ul class="list-disc ml-6 space-y-2">
          <li><strong>Transformations:</strong>
            <ul class="list-disc ml-6 space-y-1">
              <li>Create <code>_sin</code> and <code>_cos</code> columns for all angular metrics.</li>
              <li>Apply <code>log1p</code> to count-like variables (<code>n_swings</code>).</li>
              <li>Winsorize all numeric columns at [0.01, 0.99] quantiles.</li>
              <li>Scale features using <code>RobustScaler</code> for outlier-resistant normalization.</li>
            </ul>
          </li>
          <li><strong>Rationale:</strong>
            <p style="line-height:1.25em;">This combination of geometric, mechanical, and contextual variables ensures that clusters capture how players produce results, not just what results they produce.<br>By encoding angles circularly and scaling robustly, the model remains stable even with noisy Statcast inputs.</p>
          </li>
        </ul>
        <hr class="my-4 border-gray-700">

        <h3 class="font-bold text-xl mt-6 mb-2">3. Clustering Pipeline</h3>
        <ul class="list-disc ml-6 space-y-2">
          <li>Implemented in <code>scripts/cluster_archetypes.py</code>.</li>
        </ul>
        <h4 class="font-semibold text-lg mt-4 mb-2">Step-by-step process</h4>
        <ol class="list-decimal ml-6 space-y-1">
          <li>Select feature subset (defaults to all numeric or diagnostic-recommended columns).</li>
          <li>Expand angle columns into sine/cosine pairs.</li>
          <li>Apply log, winsorization, and scaling transformations.</li>
          <li>Perform <code>PCA</code> (2 components) for dimensional visualization.</li>
          <li>Run <code>KMeans</code> with an experimentally chosen k (e.g., 5).</li>
          <li>Save cluster assignments to <code>data/player_archetypes.csv</code>.</li>
          <li>Export per-cluster CSVs to <code>data/clusters/</code>.</li>
        </ol>
        <h4 class="font-semibold text-lg mt-4 mb-2">Reproducibility</h4>
        <ul class="list-disc ml-6 space-y-1">
          <li>Set <code>random_state</code> in <code>KMeans</code> for deterministic clusters.</li>
          <li>Persist preprocessing scalers and PCA metadata for consistent future predictions.</li>
        </ul>
        <hr class="my-4 border-gray-700">

        <h3 class="font-bold text-xl mt-6 mb-2">4. Evaluation &amp; Diagnostics</h3>
        <ul class="list-disc ml-6 space-y-2">
          <li>Because clustering is unsupervised, evaluation relies on interpretability and visual coherence rather than prediction accuracy.</li>
          <li><strong>Diagnostics used:</strong>
            <ul class="list-disc ml-6 space-y-1">
              <li>Centroid heatmaps — visualize feature z-scores by cluster to show distinguishing traits.</li>
              <li>Representative players — nearest neighbors to each centroid define real-world exemplars for labeling.</li>
              <li>PCA scatter plots — project 2D embeddings to assess separation.</li>
              <li>Metrics: silhouette score and Davies–Bouldin index for quantitative validation.</li>
            </ul>
          </li>
          <li><strong>Interpretation workflow:</strong>
            <ul class="list-disc ml-6 space-y-1">
              <li>Compute z-scored centroids.</li>
              <li>Plot heatmaps to highlight outlier features per group.</li>
              <li>Inspect top representative players to assign intuitive labels like “Line-Drive Contact” or “Pull-Power Barrelers.”</li>
            </ul>
          </li>
        </ul>
        <hr class="my-4 border-gray-700">

        <h3 class="font-bold text-xl mt-6 mb-2">6. Project File Map</h3>
        <table class="min-w-full text-sm border border-gray-700 mb-4">
          <thead>
            <tr class="bg-gray-800">
              <th class="px-4 py-2 text-left font-semibold">File / Directory</th>
              <th class="px-4 py-2 text-left font-semibold">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr class="bg-gray-900">
              <td class="px-4 py-2"><code>app.py</code></td>
              <td class="px-4 py-2">Streamlit UI: plotting, cluster summaries, player search</td>
            </tr>
            <tr class="bg-gray-800">
              <td class="px-4 py-2"><code>data/player_archetypes.csv</code></td>
              <td class="px-4 py-2">Main per-player dataset used by app</td>
            </tr>
            <tr class="bg-gray-900">
              <td class="px-4 py-2"><code>data/raw/unique_batters_with_names.csv</code></td>
              <td class="px-4 py-2">Optional ID → name mapping</td>
            </tr>
            <tr class="bg-gray-800">
              <td class="px-4 py-2"><code>data/clusters/*</code></td>
              <td class="px-4 py-2">Per-cluster exports and summaries</td>
            </tr>
            <tr class="bg-gray-900">
              <td class="px-4 py-2"><code>scripts/cluster_archetypes.py</code></td>
              <td class="px-4 py-2">Clustering pipeline and preprocessing logic</td>
            </tr>
            <tr class="bg-gray-800">
              <td class="px-4 py-2"><code>scripts/add_player_names.py</code></td>
              <td class="px-4 py-2">Name-enrichment utility</td>
            </tr>
            <tr class="bg-gray-900">
              <td class="px-4 py-2"><code>notebooks/</code></td>
              <td class="px-4 py-2">Exploratory data notebooks</td>
            </tr>
            <tr class="bg-gray-800">
              <td class="px-4 py-2"><code>utils/</code></td>
              <td class="px-4 py-2">Helper modules for UI and plotting</td>
            </tr>
            <tr class="bg-gray-900">
              <td class="px-4 py-2"><code>requirements.txt, requirements-streamlit.txt</code></td>
              <td class="px-4 py-2">Dependency manifests</td>
            </tr>
          </tbody>
        </table>
        <hr class="my-4 border-gray-700">

        <h3 class="font-bold text-xl mt-6 mb-2">7. Future Directions</h3>
        <ul class="list-disc ml-6 space-y-2">
          <li>Add supervised prediction tasks (next-season wOBA, HR%, discipline metrics).</li>
          <li>Introduce zone-specific and temporal features for finer clustering.</li>
          <li>Deploy a hosted dashboard with backend API for new player assignments.</li>
          <li>Implement unit tests for preprocessing consistency (winsorization, circular transforms).</li>
        </ul>
        <hr class="my-4 border-gray-700">

        <h3 class="font-bold text-xl mt-6 mb-2">8. Design Notes</h3>
        <ul class="list-disc ml-6 space-y-2">
          <li>Circular variables are expanded before PCA to prevent discontinuities.</li>
          <li>Random seeds ensure deterministic clustering.</li>
          <li>Per-cluster exports facilitate future supervised model training or archetype tracking.</li>
          <li>Streamlit UI modularization (with <code>utils/</code> helpers) keeps the front-end maintainable.</li>
        </ul>
      </section>

      <div style="margin-top:20px; display:flex; gap:12px; align-items:center;">
        <a class="launch-big" href="https://hitterarchetypes.streamlit.app" target="_blank" rel="noopener noreferrer">Launch (Live)</a>
        <a class="btn ghost" href="https://github.com/christopherhsuu/hitterarchetypes" target="_blank" rel="noopener noreferrer">Code</a>
      </div>

      <section style="margin-top:28px;">
        <h2>Purpose</h2>
        <p class="muted">Hitter Archetypes clusters MLB hitters into interpretable profiles using Statcast and tracking-derived features. The project helps reveal player types — e.g., power-first, contact-oriented, speed profiles — using transparent feature engineering and reproducible clustering.</p>

        <h2>Quick start</h2>
        <ol>
          <li>Install dependencies and ensure `data/player_archetypes.csv` is present.</li>
          <li>Run the Streamlit app: <code>streamlit run app.py</code> to open the interactive explorer.</li>
          <li>Optionally run the clustering script to recompute clusters with different `k` values.</li>
        </ol>

        <h2>Data preparation (what I did)</h2>
        <ol>
          <li>Stored raw Statcast swing-level CSVs in <code>data/raw/</code>.</li>
          <li>Aggregated per-player metrics (mean, median, p95) into <code>data/player_archetypes.csv</code> using <code>scripts/cluster_archetypes.py</code>.</li>
          <li>Enriched player mappings with <code>data/raw/unique_batters_with_names.csv</code> for readable names.</li>
        </ol>

        <h2>Feature engineering</h2>
        <ol>
          <li>Computed power/contact metrics (launch speed, pct_hard_hit) and swing mechanics (bat speed, swing length).</li>
          <li>Transformed angle features to sin/cos pairs to avoid wrap-around artifacts.</li>
          <li>Log-transformed count columns, winsorized at 1st/99th percentiles, and scaled with RobustScaler.</li>
        </ol>

        <h2>Clustering pipeline</h2>
        <ol>
          <li>Select features and preprocess (angle expansion, log1p, winsorize, scale).</li>
          <li>Optionally apply PCA for visualization (2 components).</li>
          <li>Run KMeans (example used k=5) with fixed random_state and export per-cluster CSVs.</li>
        </ol>

        <h2>Evaluation &amp; diagnostics</h2>
        <p class="muted">Inspect centroid heatmaps, representative players, and PCA scatter plots. Use silhouette scores or Davies-Bouldin index as quantitative checks and refine features/sampling thresholds accordingly.</p>

        <h2>App usage</h2>
        <p class="muted">`app.py` renders an interactive PCA scatter, centroid heatmaps, and generated plain-English cluster summaries. Search for players by name to inspect deviations from cluster centroids and export cluster CSVs for downstream work.</p>

        <h2>Next steps</h2>
        <p class="muted">Future work includes adding supervised prediction tasks using archetype features, richer temporal aggregations, unit tests for transformations, and a deployed dashboard for sharing results.</p>
      </section>
    </div>
    </main>

    <footer class="site-footer">
      <div class="container">
        <p class="muted">© 2025 Christopher Hsu</p>
      </div>
    </footer>
  </body>
</html>